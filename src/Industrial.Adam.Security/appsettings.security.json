{
  "Security": {
    "Headers": {
      "XFrameOptions": {
        "Enabled": true,
        "Value": "DENY"
      },
      "XContentTypeOptions": {
        "Enabled": true,
        "Value": "nosniff"
      },
      "XXssProtection": {
        "Enabled": true,
        "Value": "1; mode=block"
      },
      "ReferrerPolicy": {
        "Enabled": true,
        "Value": "strict-origin-when-cross-origin"
      },
      "PermissionsPolicy": {
        "Enabled": true,
        "Value": "camera=(), microphone=(), geolocation=(), payment=(), usb=()"
      },
      "StrictTransportSecurity": {
        "Enabled": true,
        "Value": "max-age=31536000; includeSubDomains"
      },
      "ContentSecurityPolicy": {
        "Enabled": true,
        "DefaultSrc": "'self'",
        "ScriptSrc": "'self'",
        "StyleSrc": "'self' 'unsafe-hashes'",
        "ImgSrc": "'self' data: https:",
        "ConnectSrc": "'self'",
        "FontSrc": "'self'",
        "ObjectSrc": "'none'",
        "MediaSrc": "'self'",
        "FrameSrc": "'none'",
        "ChildSrc": "'self'",
        "FormAction": "'self'",
        "FrameAncestors": "'none'",
        "BaseUri": "'self'",
        "ReportUri": "/api/security/csp-report",
        "UpgradeInsecureRequests": true,
        "BlockAllMixedContent": false,
        "NonceGeneration": true,
        "RequireTrustedTypes": false
      },
      "CustomHeaders": {
        "X-Industrial-Adam": "Security-Enabled",
        "X-Content-Type-Options": "nosniff"
      }
    },
    "Validation": {
      "MaxRequestSize": 10485760,
      "MaxParameterLength": 4096,
      "MaxHeaderLength": 8192,
      "MaxFileSize": 52428800,
      "AllowedFileExtensions": [
        ".jpg", ".jpeg", ".png", ".gif", ".pdf", ".txt", ".csv", ".json", ".xml", ".zip"
      ]
    },
    "Monitoring": {
      "CheckInterval": "00:01:00",
      "BruteForceThreshold": 10,
      "CredentialStuffingThreshold": 15,
      "RapidFailureThreshold": 5,
      "MinSuccessRate": 70.0,
      "HighRiskEventThreshold": 5,
      "AlertWindowMinutes": 30
    },
    "RateLimit": {
      "RequestsPerMinute": 100,
      "AuthRequestsPerMinute": 10,
      "ApiRequestsPerMinute": 200
    },
    "RateLimiting": {
      "GlobalLimits": {
        "RequestsPerWindow": 1000,
        "WindowSeconds": 60,
        "SegmentsPerWindow": 4,
        "QueueLimit": 100
      },
      "ApiLimits": {
        "RequestsPerWindow": 100,
        "WindowSeconds": 60,
        "SegmentsPerWindow": 4,
        "QueueLimit": 10
      },
      "AuthenticationLimits": {
        "RequestsPerWindow": 10,
        "WindowSeconds": 60,
        "SegmentsPerWindow": 2,
        "QueueLimit": 0
      },
      "RetryAfterSeconds": 60
    }
  },
  "Logging": {
    "LogLevel": {
      "Industrial.Adam.Security": "Information",
      "Industrial.Adam.Security.Logging.SecurityEventLogger": "Debug",
      "Industrial.Adam.Security.Middleware": "Information",
      "Industrial.Adam.Security.Monitoring": "Information"
    }
  },
  "Serilog": {
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Industrial.Adam.Security": "Debug"
      }
    },
    "WriteTo": [
      {
        "Name": "File",
        "Args": {
          "path": "logs/security-.txt",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 7,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}"
        }
      },
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "{Timestamp:HH:mm:ss} [{Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}"
        }
      }
    ],
    "Enrich": [
      "FromLogContext",
      "WithMachineName",
      "WithThreadId"
    ]
  }
}